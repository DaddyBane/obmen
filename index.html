<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–û–±–º–µ–Ω–Ω–∏–∫ –≤–∞–ª—é—Ç - –∑–∞—è–≤–∫–∞</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 500px; margin: 20px auto; }
  label { display: block; margin-top: 15px; }
  input, select, button, textarea { width: 100%; padding: 8px; margin-top: 5px; }
  button { background: #007bff; color: white; border: none; cursor: pointer; }
  button:hover { background: #0056b3; }
  #message { margin-top: 20px; font-weight: bold; color: green; }
</style>
</head>
<body>
<h2>–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –æ–±–º–µ–Ω</h2>
<form id="exchangeForm">
  <label>–ò–º—è:
    <input name="name" required />
  </label>
  <label>–ö–æ–Ω—Ç–∞–∫—Ç (Telegram –∏–ª–∏ email):
    <input name="contact" required />
  </label>
  <label>–û—Ç–¥–∞—ë—Ç–µ:
    <select name="from_currency">
      <option value="RUB">RUB</option>
    </select>
  </label>
  <label>–ü–æ–ª—É—á–∞–µ—Ç–µ:
    <select name="to_currency" required>
      <option value="USDT TRC-20">USDT TRC-20</option>
      <option value="BTC">BTC</option>
    </select>
  </label>
  <label>–°—É–º–º–∞:
    <input type="number" name="amount" min="1" step="any" required />
  </label>
  <label>–ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏–ø—Ç—É (–∞–¥—Ä–µ—Å USDT TRC-20 –∏–ª–∏ BTC):
    <textarea name="crypto_address" rows="2" required></textarea>
  </label>
  <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
</form>

<div id="message"></div>

<script>
  const form = document.getElementById('exchangeForm');
  const msg = document.getElementById('message');

  form.onsubmit = async (e) => {
    e.preventDefault();
    const data = {
      name: form.name.value.trim(),
      contact: form.contact.value.trim(),
      from_currency: form.from_currency.value,
      to_currency: form.to_currency.value,
      amount: parseFloat(form.amount.value),
      crypto_address: form.crypto_address.value.trim(),
    };

    try {
      const res = await fetch('/api/submit', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
      });
      const json = await res.json();
      if (json.ok) {
        msg.textContent = "üîÑ –û–∂–∏–¥–∞–π—Ç–µ –≤—ã–¥–∞—á—É —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤. –ú—ã —Å–∫–æ—Ä–æ —Å –≤–∞–º–∏ —Å–≤—è–∂–µ–º—Å—è.";
        form.reset();
      } else {
        msg.textContent = "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏.";
      }
    } catch (e) {
      msg.textContent = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏.";
    }
  };
</script>
</body>
</html>
